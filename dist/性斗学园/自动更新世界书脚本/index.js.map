{"version":3,"file":"index.js","mappings":"mFAEA,MAAMA,EAAiB,YAGjBC,EAAkB,+DAEjBC,eAAeC,IACpB,MAAMC,SACGC,aANY,SAMkBC,KAAKC,GALnB,QAK4BA,EAAMC,OAA8BC,QAAQC,QAAU,QAErGC,QAAsBC,MAAM,GAAGX,aAClCY,KAAKC,GAAYA,EAASC,QAC1BF,KAAKE,GAAQA,EAAKL,QAClBM,MAAM,IAAM,SAEX,EAAQZ,EAASO,EAAe,cAI9BM,mBACJjB,QACMY,MAAM,GAAGX,mBAAiCY,KAAKC,GAAYA,EAASI,SAG5EC,OAAOC,QAAQ,0BAA2BpB,GAC1CqB,WAAW,IAAMC,aAAa,gBAAiB,KACjD,CAEAnB,W","sources":["src://tavern_helper_template/src/性斗学园/自动更新世界书脚本/index.ts"],"sourcesContent":["import { compare } from 'compare-versions';\n\nconst CHARACTER_NAME = '性斗学园超级重制版';\nconst WORLDBOOK_NAME = '性斗学园';\nconst VERSION_ENTRY_NAME = '版本号';\nconst GITHUB_BASE_URL = 'https://raw.githack.com/vincentrong2005/Fatria/main/src/性斗学园';\n\nexport async function checkUpdate() {\n  const version =\n    (await getWorldbook(WORLDBOOK_NAME)).find(entry => entry.name === VERSION_ENTRY_NAME)?.content.trim() ?? '0.0.0';\n\n  const remoteVersion = await fetch(`${GITHUB_BASE_URL}/版本号.txt`)\n    .then(response => response.text())\n    .then(text => text.trim())\n    .catch(() => '0.0.0');\n\n  if (compare(version, remoteVersion, '>=')) {\n    return;\n  }\n\n  await importRawCharacter(\n    CHARACTER_NAME,\n    await fetch(`${GITHUB_BASE_URL}/性斗学园超级重制版.png`).then(response => response.blob()),\n  );\n\n  toastr.success('角色卡自动更新成功, 准备刷新页面以生效...', CHARACTER_NAME);\n  setTimeout(() => triggerSlash('/reload-page'), 3000);\n}\n\ncheckUpdate();\n"],"names":["CHARACTER_NAME","GITHUB_BASE_URL","async","checkUpdate","version","getWorldbook","find","entry","name","content","trim","remoteVersion","fetch","then","response","text","catch","importRawCharacter","blob","toastr","success","setTimeout","triggerSlash"],"ignoreList":[],"sourceRoot":""}