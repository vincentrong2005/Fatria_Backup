{"version":3,"file":"index.js","mappings":"mFAEA,MAAMA,EAAiB,YAGjBC,EAAkB,+DAEjBC,eAAeC,IACpB,MAAMC,SACGC,aANY,SAOhBC,KAAKC,GANe,QAMNA,EAAMC,OACnBC,QAAQC,QAAU,QAElBC,QAAsBC,MAAM,GAAGX,aAClCY,KAAKC,GAAYA,EAASC,QAC1BF,KAAKE,GAAQA,EAAKL,QAClBM,MAAM,IAAM,SAEX,EAAQZ,EAASO,EAAe,cAI9BM,mBACJjB,QACMY,MAAM,GAAGX,mBAAiCY,KAAKC,GAAYA,EAASI,SAG5EC,OAAOC,QAAQ,0BAA2BpB,GAC1CqB,WAAW,IAAMC,aAAa,gBAAiB,KACjD,CAEAnB,W","sources":["src://tavern_helper_template/src/性斗学园/自动更新世界书脚本/index.ts"],"sourcesContent":["import { compare } from 'compare-versions';\r\n\r\nconst CHARACTER_NAME = '性斗学院超级重制版';\r\nconst WORLDBOOK_NAME = '性斗学园';\r\nconst VERSION_ENTRY_NAME = '版本号';\r\nconst GITHUB_BASE_URL = 'https://raw.githack.com/vincentrong2005/Fatria/main/src/性斗学园';\r\n\r\nexport async function checkUpdate() {\r\n  const version =\r\n    (await getWorldbook(WORLDBOOK_NAME))\r\n      .find(entry => entry.name === VERSION_ENTRY_NAME)\r\n      ?.content.trim() ?? '0.0.0';\r\n\r\n  const remoteVersion = await fetch(`${GITHUB_BASE_URL}/版本号.txt`)\r\n    .then(response => response.text())\r\n    .then(text => text.trim())\r\n    .catch(() => '0.0.0');\r\n\r\n  if (compare(version, remoteVersion, '>=')) {\r\n    return;\r\n  }\r\n\r\n  await importRawCharacter(\r\n    CHARACTER_NAME,\r\n    await fetch(`${GITHUB_BASE_URL}/性斗学园超级重制版.png`).then(response => response.blob()),\r\n  );\r\n\r\n  toastr.success('角色卡自动更新成功, 准备刷新页面以生效...', CHARACTER_NAME);\r\n  setTimeout(() => triggerSlash('/reload-page'), 3000);\r\n}\r\n\r\ncheckUpdate();\r\n"],"names":["CHARACTER_NAME","GITHUB_BASE_URL","async","checkUpdate","version","getWorldbook","find","entry","name","content","trim","remoteVersion","fetch","then","response","text","catch","importRawCharacter","blob","toastr","success","setTimeout","triggerSlash"],"ignoreList":[],"sourceRoot":""}