<head><script type="module">var e={426:(e,a)=>{a.A=(e,a)=>{const s=e.__vccOpts||e;for(const[e,n]of a)s[e]=n;return s}}},a={};const s=Vue,n={class:'variable-update-beautifier'},t={key:0,class:'update-container'},l={class:'header-left'},c={class:'update-content'},r=['innerHTML'],o={key:1,class:'no-update'},p=(0,s.defineComponent)({__name:'app',setup(e){const a=(0,s.ref)(''),p=(0,s.ref)(!1),i=(0,s.computed)(()=>{if(!a.value)return'';let e=a.value;return e=e.replace(/<Analysis>([\s\S]*?)<\/Analysis>/gi,(e,a)=>`\n        <div class="analysis-section">\n          <div class="section-header">\n            <i class="fas fa-search"></i>\n            <span>分析</span>\n          </div>\n          <div class="section-content">\n            ${d(a.trim())}\n          </div>\n        </div>\n      `),e=e.replace(/<JSONPatch>([\s\S]*?)<\/JSONPatch>/gi,(e,a)=>`\n        <div class="jsonpatch-section">\n          <div class="section-header">\n            <i class="fas fa-code"></i>\n            <span> 变量更新代码 </span>\n          </div>\n          <div class="section-content">\n            ${v(a.trim())}\n          </div>\n        </div>\n      `),e}),d=e=>{let a=e.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');return a=a.replace(/^- (.+)$/gm,'<div class="analysis-item">• $1</div>'),a=a.replace(/^  - (.+)$/gm,'<div class="analysis-subitem">  • $1</div>'),a=a.replace(/\n/g,'<br>'),a},v=e=>{try{const a=JSON.parse(e),s=JSON.stringify(a,null,2);return u(s)}catch(a){return`<pre class="json-error">${m(e)}</pre>`}},u=e=>{let a=m(e);return a=a.replace(/"op"\s*:\s*"([^"]+)"/g,'<span class="json-key">"op"</span>: <span class="json-op">"$1"</span>'),a=a.replace(/"([^"]+)"\s*:/g,(e,a)=>'op'===a?e:`<span class="json-key">"${a}"</span>:`),a=a.replace(/:\s*"([^"]+)"/g,': <span class="json-string">"$1"</span>'),a=a.replace(/\[\s*"([^"]+)"\s*\]/g,'[<span class="json-string">"$1"</span>]'),a=a.replace(/"([^"]+)",/g,'<span class="json-string">"$1"</span>,'),a=a.replace(/:\s*(\d+)/g,': <span class="json-number">$1</span>'),a=a.replace(/:\s*(true|false)/g,': <span class="json-boolean">$1</span>'),a=a.replace(/:\s*(null)/g,': <span class="json-null">$1</span>'),`<pre class="json-code">${a}</pre>`},m=e=>e.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#039;'),g=()=>{p.value=!p.value};return(0,s.onMounted)(()=>{console.info('[变量更新] 组件已加载'),setTimeout(()=>{(()=>{try{const e=getCurrentMessageId(),s=getChatMessages(e);if(0===s.length)return void console.warn('[变量更新] 未找到当前消息');const n=s[0].message,t=/<update(?:variable)?>([\s\S]*?)<\/update(?:variable)?>/gi.exec(n);t&&t[1]?(a.value=t[1].trim(),console.info('[变量更新] 已提取更新内容，长度:',a.value.length)):console.info('[变量更新] 未找到 <update> 或 <UpdateVariable> 标签')}catch(e){console.error('[变量更新] 提取内容时出错:',e)}})()},100)}),(e,d)=>((0,s.openBlock)(),(0,s.createElementBlock)('div',n,[a.value?((0,s.openBlock)(),(0,s.createElementBlock)('div',t,[(0,s.createElementVNode)('div',{class:(0,s.normalizeClass)(['update-card',{'is-expanded':p.value}])},[(0,s.createCommentVNode)(' 折叠栏头部 '),(0,s.createElementVNode)('div',{class:'update-header',onClick:g},[(0,s.createElementVNode)('div',l,[(0,s.createElementVNode)('div',{class:(0,s.normalizeClass)(['expand-icon',{rotated:p.value}])},[...d[0]||(d[0]=[(0,s.createElementVNode)('i',{class:'fas fa-chevron-down'},null,-1)])],2),d[1]||(d[1]=(0,s.createElementVNode)('div',{class:'header-title'},[(0,s.createElementVNode)('i',{class:'fas fa-sync-alt'}),(0,s.createElementVNode)('span',null,'变量更新')],-1))]),d[2]||(d[2]=(0,s.createElementVNode)('div',{class:'header-badge'},[(0,s.createElementVNode)('i',{class:'fas fa-code'})],-1))]),(0,s.createCommentVNode)(' 折叠内容 '),(0,s.withDirectives)((0,s.createElementVNode)('div',c,[(0,s.createElementVNode)('div',{class:'content-wrapper',innerHTML:i.value},null,8,r)],512),[[s.vShow,p.value]])],2)])):((0,s.openBlock)(),(0,s.createElementBlock)('div',o,[...d[3]||(d[3]=[(0,s.createElementVNode)('p',null,'未找到变量更新内容',-1)])]))]))}});var i=function s(n){var t=a[n];if(void 0!==t)return t.exports;var l=a[n]={exports:{}};return e[n](l,l.exports,s),l.exports}(426);const d=(0,i.A)(p,[['__scopeId','data-v-31b62c22']]);$(()=>{(0,s.createApp)(d).mount('#app')});
//# sourceMappingURL=index.js.map</script><style>.variable-update-beautifier[data-v-31b62c22]{width:100%;margin:0;padding:0}.update-container[data-v-31b62c22]{margin:1rem 0}.update-card[data-v-31b62c22]{background:linear-gradient(135deg,rgba(99,102,241,0.1) 0%,rgba(236,72,153,0.1) 100%);border:1px solid hsla(0,0%,100%,.15);border-radius:.75rem;overflow:hidden;backdrop-filter:blur(20px) saturate(180%);box-shadow:0 4px 16px rgba(0,0,0,.2),0 2px 4px rgba(99,102,241,.15),inset 0 1px 0 hsla(0,0%,100%,.1);transition:all .3s cubic-bezier(0.4,0,0.2,1);background-image:radial-gradient(circle at 20% 30%,rgba(99,102,241,0.15) 0%,transparent 50%),radial-gradient(circle at 80% 70%,rgba(236,72,153,0.15) 0%,transparent 50%)}.update-card.is-expanded[data-v-31b62c22]{border-color:rgba(236,72,153,.3);box-shadow:0 8px 24px rgba(0,0,0,.3),0 4px 8px rgba(99,102,241,.2),inset 0 1px 0 hsla(0,0%,100%,.15)}.update-header[data-v-31b62c22]{display:flex;align-items:center;justify-content:space-between;padding:1rem 1.25rem;cursor:pointer;-webkit-user-select:none;user-select:none;transition:all .2s ease}.update-header[data-v-31b62c22]:hover{background:hsla(0,0%,100%,.05)}.update-header .header-left[data-v-31b62c22]{display:flex;align-items:center;gap:.75rem;flex:1}.update-header .expand-icon[data-v-31b62c22]{width:1.5rem;height:1.5rem;display:flex;align-items:center;justify-content:center;color:#6366f1;transition:transform .3s cubic-bezier(0.4,0,0.2,1)}.update-header .expand-icon.rotated[data-v-31b62c22]{transform:rotate(180deg)}.update-header .header-title[data-v-31b62c22]{display:flex;align-items:center;gap:.5rem;color:#e5e7eb;font-weight:600;font-size:1rem}.update-header .header-title i[data-v-31b62c22]{color:#6366f1}.update-header .header-badge[data-v-31b62c22]{width:2rem;height:2rem;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,rgba(99,102,241,0.3) 0%,rgba(236,72,153,0.3) 100%);border-radius:50%;color:#6366f1;font-size:.9rem}.update-content[data-v-31b62c22]{border-top:1px solid hsla(0,0%,100%,.1);padding:1.5rem;animation:slideDown-31b62c22 .3s cubic-bezier(0.4,0,0.2,1)}@keyframes slideDown-31b62c22{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.content-wrapper[data-v-31b62c22]{color:#e5e7eb;font-size:.95rem;line-height:1.7}.content-wrapper[data-v-31b62c22] .analysis-section,.content-wrapper[data-v-31b62c22] .jsonpatch-section{margin-bottom:1.5rem}.content-wrapper[data-v-31b62c22] .analysis-section:last-child,.content-wrapper[data-v-31b62c22] .jsonpatch-section:last-child{margin-bottom:0}.content-wrapper[data-v-31b62c22] .section-header{display:flex;align-items:center;gap:.5rem;margin-bottom:.75rem;padding-bottom:.5rem;border-bottom:2px solid rgba(99,102,241,.3);color:#ec4899;font-weight:600;font-size:1rem}.content-wrapper[data-v-31b62c22] .section-header i{color:#6366f1}.content-wrapper[data-v-31b62c22] .section-content{color:#d1d5db}.content-wrapper[data-v-31b62c22] .analysis-item{margin:.1rem 0;padding-left:1rem;color:#e5e7eb;line-height:1}.content-wrapper[data-v-31b62c22] .analysis-subitem{margin:.15rem 0;padding-left:2rem;color:#cbd5e1;font-size:.9em;line-height:1.4}.content-wrapper[data-v-31b62c22] .json-code{margin:.75rem 0;padding:1rem;background:rgba(0,0,0,.3);border-radius:.5rem;overflow-x:auto;border:1px solid hsla(0,0%,100%,.1);font-family:"Fira Code","Courier New","Consolas",monospace;font-size:.85rem;line-height:1.6}.content-wrapper[data-v-31b62c22] .json-code .json-key{color:#6366f1;font-weight:600}.content-wrapper[data-v-31b62c22] .json-code .json-string{color:#10b981}.content-wrapper[data-v-31b62c22] .json-code .json-number{color:#f59e0b}.content-wrapper[data-v-31b62c22] .json-code .json-boolean{color:#ec4899}.content-wrapper[data-v-31b62c22] .json-code .json-null{color:#9ca3af}.content-wrapper[data-v-31b62c22] .json-code .json-op{color:#8b5cf6;font-weight:600}.content-wrapper[data-v-31b62c22] .json-error{margin:.75rem 0;padding:1rem;background:rgba(239,68,68,.1);border:1px solid rgba(239,68,68,.3);border-radius:.5rem;color:#fca5a5;font-family:"Courier New",monospace;font-size:.85rem;white-space:pre-wrap}.no-update[data-v-31b62c22]{padding:2rem;text-align:center;color:#9ca3af;font-size:.9rem}.no-update p[data-v-31b62c22]{margin:0}

/*# sourceMappingURL=main.css.map*/</style></head><body><div id="app"></div></body>