{"version":3,"file":"index.js","mappings":"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","sources":["src://tavern_helper_template/node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js","src://tavern_helper_template/webpack/bootstrap","src://tavern_helper_template/external var \"Vue\"","webpack://tavern_helper_template/./src/性斗学园/选项UI/app.vue?933b","webpack://tavern_helper_template/src/性斗学园/选项UI/app.vue?cd7f","src://tavern_helper_template/src/性斗学园/选项UI/index.ts"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","const __WEBPACK_NAMESPACE_OBJECT__ = Vue;","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"option-beautifier\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"options-container\"\n};\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = { class: \"option-label\" };\nconst _hoisted_5 = { class: \"option-content\" };\nconst _hoisted_6 = {\n    key: 1,\n    class: \"no-options\"\n};\nimport { ref, onMounted } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'app',\n    setup(__props) {\n        const OPTION_REGEX = /<option>([\\s\\S]*?)<\\/option>/g;\n        const options = ref([]);\n        // 解析选项文本\n        const parseOptions = (text) => {\n            const items = [];\n            // 按行分割\n            const lines = text\n                .split('\\n')\n                .map(line => line.trim())\n                .filter(line => line.length > 0);\n            for (const line of lines) {\n                // 匹配选项格式：\n                // 1. A. 文本\n                // 2. A、文本\n                // 3. A) 文本\n                // 4. (A) 文本\n                let match = line.match(/^([A-Z])\\.\\s*(.+)$/);\n                if (!match) {\n                    match = line.match(/^([A-Z])、\\s*(.+)$/);\n                }\n                if (!match) {\n                    match = line.match(/^([A-Z])\\)\\s*(.+)$/);\n                }\n                if (!match) {\n                    match = line.match(/^\\(([A-Z])\\)\\s*(.+)$/);\n                }\n                if (match) {\n                    items.push({\n                        label: match[1],\n                        text: match[2].trim(),\n                    });\n                }\n            }\n            // 如果没有匹配到标准格式，尝试按序号分割\n            if (items.length === 0) {\n                // 尝试匹配数字序号：1. 2. 3. 等\n                for (let i = 0; i < lines.length; i++) {\n                    const line = lines[i];\n                    const numMatch = line.match(/^(\\d+)\\.\\s*(.+)$/);\n                    if (numMatch) {\n                        // 将数字转换为字母（1->A, 2->B, 3->C...）\n                        const num = parseInt(numMatch[1]);\n                        const label = String.fromCharCode(64 + num); // 65是'A'的ASCII码\n                        items.push({\n                            label: label,\n                            text: numMatch[2].trim(),\n                        });\n                    }\n                }\n            }\n            return items;\n        };\n        // 提取并显示选项\n        const extractOptions = () => {\n            try {\n                // 获取当前消息ID\n                const messageId = getCurrentMessageId();\n                // 获取当前消息内容\n                const messages = getChatMessages(messageId);\n                if (messages.length === 0) {\n                    console.warn('[选项美化] 未找到当前消息');\n                    return;\n                }\n                const message = messages[0];\n                const messageText = message.message;\n                // 使用正则表达式提取 <option> 标签中的内容\n                const regex = /<option>([\\s\\S]*?)<\\/option>/;\n                const match = messageText.match(regex);\n                if (match && match[1]) {\n                    const optionText = match[1].trim();\n                    options.value = parseOptions(optionText);\n                    console.info('[选项美化] 已提取选项，数量:', options.value.length);\n                }\n                else {\n                    console.info('[选项美化] 未找到 <option> 标签');\n                }\n            }\n            catch (error) {\n                console.error('[选项美化] 提取选项时出错:', error);\n            }\n        };\n        // 选择选项并复制到输入框\n        const selectOption = (optionText) => {\n            try {\n                // 使用 window.parent 访问父窗口\n                const parentWindow = window.parent;\n                const $parent = parentWindow.$ || parentWindow.jQuery;\n                if (!$parent) {\n                    console.warn('[选项美化] 无法访问父窗口的jQuery');\n                    return;\n                }\n                // 查找输入框（尝试多种选择器）\n                const inputSelectors = [\n                    '#send_textarea',\n                    'textarea[name=\"send_textarea\"]',\n                    '.send_textarea',\n                    'textarea[placeholder*=\"Message\"]',\n                    'textarea[placeholder*=\"消息\"]',\n                    '.chat-input textarea',\n                    '#chat-input textarea',\n                ];\n                let $input = null;\n                for (const selector of inputSelectors) {\n                    $input = $parent(selector);\n                    if ($input.length > 0) {\n                        break;\n                    }\n                }\n                if ($input && $input.length > 0) {\n                    // 设置输入框的值\n                    $input.val(optionText);\n                    // 触发 input 事件，确保 Vue/React 等框架能检测到变化\n                    $input.trigger('input');\n                    $input.trigger('change');\n                    // 聚焦输入框\n                    $input.focus();\n                    console.info('[选项美化] 已选择选项:', optionText);\n                }\n                else {\n                    console.warn('[选项美化] 未找到输入框');\n                    // 如果找不到输入框，尝试使用剪贴板API\n                    if (navigator.clipboard) {\n                        navigator.clipboard.writeText(optionText).catch(() => {\n                            console.warn('[选项美化] 复制到剪贴板失败');\n                        });\n                    }\n                }\n            }\n            catch (error) {\n                console.error('[选项美化] 选择选项时出错:', error);\n            }\n        };\n        onMounted(() => {\n            console.info('[选项美化] 组件已加载');\n            // 延迟提取，确保消息已加载\n            setTimeout(() => {\n                extractOptions();\n            }, 100);\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (options.value.length > 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(options.value, (option, index) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: index,\n                                class: _normalizeClass([\"option-card\", { 'option-card-hover': true }]),\n                                onClick: ($event) => (selectOption(option.text))\n                            }, [\n                                _createCommentVNode(\" 选项标签 \"),\n                                _createElementVNode(\"div\", _hoisted_4, _toDisplayString(option.label), 1 /* TEXT */),\n                                _createCommentVNode(\" 选项内容 \"),\n                                _createElementVNode(\"div\", _hoisted_5, _toDisplayString(option.text), 1 /* TEXT */),\n                                _createCommentVNode(\" 点击提示 \"),\n                                _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"option-hint\" }, [\n                                    _createElementVNode(\"i\", { class: \"fas fa-mouse-pointer\" }),\n                                    _createTextVNode(\" 点击选择 \")\n                                ], -1 /* CACHED */))\n                            ], 8 /* PROPS */, _hoisted_3));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [...(_cache[1] || (_cache[1] = [\n                            _createElementVNode(\"p\", null, \"未找到选项内容\", -1 /* CACHED */)\n                        ]))]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./app.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./app.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./app.vue?vue&type=style&index=0&id=3e351eda&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3e351eda\"]])\n\nexport default __exports__","import { createApp } from 'vue';\nimport app from './app.vue';\n\n$(() => {\n  createApp(app).mount('#app');\n});\n"],"names":["exports","sfc","props","target","__vccOpts","key","val","__webpack_module_cache__","Vue","_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","__name","setup","__props","options","ref","extractOptions","messageId","getCurrentMessageId","messages","getChatMessages","length","console","warn","messageText","message","regex","match","optionText","trim","value","text","items","lines","split","map","line","filter","push","label","i","numMatch","num","parseInt","String","fromCharCode","parseOptions","info","error","onMounted","setTimeout","_ctx","_cache","option","index","onClick","$event","parentWindow","window","parent","$parent","$","jQuery","inputSelectors","$input","selector","trigger","focus","navigator","clipboard","writeText","catch","__webpack_require__","moduleId","cachedModule","undefined","module","__webpack_modules__","createApp","app","mount"],"ignoreList":[],"sourceRoot":""}